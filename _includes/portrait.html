{% if include.lookup %}
  {% assign member = site.members 
    | where_exp: "member", "member.slug == include.lookup"
    | first
  %}
{% else %}
  {% assign member = include %}
{% endif %}

{% assign type = site.data.types[member.role] %}

<div class="portrait-wrapper">
  {% if member.role == "faculty" %}
    <a
      href="{{ member.url | relative_url }}"
      class="portrait"
      data-style="{{ include.style }}"
      aria-label="{{ member.name | default: "member link" }}"
    >
  {% elsif member.url %}
    <a
      {% if member.url contains '://' %}
        href="{{ member.url }}" target="_blank" rel="noopener"
      {% else %}
        href="{{ member.url | relative_url }}"
      {% endif %}
      class="portrait"
      data-style="{{ include.style }}"
      aria-label="{{ member.name | default: "member link" }}"
    >
  {% else %}
    <div
      class="portrait"
      data-style="{{ include.style }}"
      aria-label="{{ member.name | default: "member" }}"
    >
  {% endif %}

      {% if type %}
        {% include icon.html icon=type.icon %}
      {% endif %}

      <img
        src="{{ member.image | relative_url }}"
        class="portrait-image"
        alt="member portrait"
        loading="lazy"
        {% include fallback.html %}
      >

      {% if member.name %}
        <span class="portrait-name">
          {{ member.name }}
        </span>
      {% endif %}
    </a>
      {% if member.description or type %}
        <span class="portrait-description">
          {{ member.description | default: type.description }}
        </span>
      {% endif %}

      {% if member.affiliation %}
        <span class="portrait-affiliation">
          {{ member.affiliation }}
        </span>
      {% endif %}

  {% if member.role == "faculty" or member.url %}
  {% else %}
    </div>
  {% endif %}
</div>
